---
issue: 603
title: 'Crashes with "ResizeObserver loop limit exceeded" or hangs in requestAnimationFrame loop'
url: https://github.com/mgmeyers/obsidian-kanban/issues/603
author: pjeby
created: 2022-07-28T11:39:53Z
os: Windows
status: verified
investigation_notes: 'ResizeObserver loop limit exceeded crash when switching workspaces with popout windows containing kanbans. Complex rendering/lifecycle issue. RAF calls piling up. May need cleanup on workspace change events.'
fix_attempted: true
fix_pr: 'src/components/MarkdownRenderer/MarkdownRenderer.tsx - throttle resize observer updates with rAF'
---

## Description

### Describe the bug

What happens: the entire workspace disappears; entering the console debugger and stopping reveals either an infinite loop of Kanban's RAF calls calling RAF calls, or a hang on an unhandled exception (ResizeObserver loop limit exceeded). (And AFAICT Kanban's the only plugin I have active at the time that uses ResizeObserver.)

When it happens: when switching between workspaces, especially while leaving a workspace that contains one or more kanbans in a popout window, to go to one with a Kanban only in the main window.

### Expected Behavior

Not crashing. ;-)

### Steps to reproduce

It is not 100% reproducible, but it happens regularly enough to be annoying now. Obsidian 0.15.9, installer 0.15.8, and I'm using PR, QE, and HE, though none of them appear directly involved in the issue. I am switching workspaces using Workspaces Plus 0.3.2.

It is more likely to happen with repeated switches that open and close a secondary window, i.e. one workspace with a kanban in main, and another with a whole bunch of kanbans in a second window. Switching between workspaces like that will generally do the trick in relatively short order.

In the process of investigating this, I learned some interesting odds and ends about how Obsidian switches workspaces, and it is _messy_. It can trigger active-leaf-change events pointing to leaves that have already been detached from the workspace, among other things that could potentially affect plugins with complex rendering like Kanban. ;-)

### Relevant errors (if available)

_No response_

### Operating system

Windows

## Investigation Notes

<!-- To be filled during triage -->

## Fix Attempts

<!-- Document any attempted fixes -->
